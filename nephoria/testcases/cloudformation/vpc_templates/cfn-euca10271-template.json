{
    "AWSTemplateFormatVersion": "2010-09-09", 
    "Description": "Cloudformation Example => EUCA-10271 - generated by VisualOps, Routing Table and Security Group Fail to Delete After Successful Cloudformation Deployment", 
    "Parameters": {
        "ImageId": {
            "Description":"Ubuntu Image id",
            "Type":"String",
            "NoEcho":"False"
        },

        "KeyName": {
            "Description":"Name of an existing EC2 KeyPair to enable SSH access to the instances",
            "Type":"AWS::EC2::KeyPair::KeyName",
            "ConstraintDescription": "The name of an existing EC2 KeyPair",
            "NoEcho":"False"
        },

        "InstanceType" : {
            "Description" : "Type of EC2 instance to launch.",
            "Type" : "String",
            "Default" : "m1.xlarge",
            "AllowedValues" : [ "m1.small","t1.micro","m3.medium","c1.medium","m1.large","m1.xlarge","c1.xlarge","m2.xlarge","m3.xlarge","m2.2xlarge","m3.2xlarge", "cc1.4xlarge","m2.4xlarge","hi1.4xlarge", "cc2.8xlarge", "cg1.4xlarge", "cr1.8xlarge", "hs1.8xlarge"],
            "ConstraintDescription" : "must be a valid EC2 instance type."
        }
    }, 
    "Resources": {
        "AttachInternetGateway": {
            "Properties": {
                "InternetGatewayId": {
                    "Ref": "InternetGateway2Internetgateway"
                }, 
                "VpcId": {
                    "Ref": "VPC2vpc"
                }
            }, 
            "Type": "AWS::EC2::VPCGatewayAttachment"
        }, 
        "Instance2host0": {
            "Properties": {
                "ImageId": {
                    "Ref": "ImageId"
                }, 
                "InstanceType": {
                    "Ref": "InstanceType"
                }, 
                "KeyName": {
                    "Ref": "KeyName"
                }, 
                "Monitoring": "true", 
                "NetworkInterfaces": [
                    {
                        "DeviceIndex": "0", 
                        "NetworkInterfaceId": {
                            "Ref": "NetworkInterface2host0eni0"
                        }
                    }
                ], 
                "Tags": [
                         {"Key" : "Application", "Value" : { "Ref" : "AWS::StackId"}}
                ]
            }, 
            "Type": "AWS::EC2::Instance"
        }, 
        "InternetGateway2Internetgateway": {
            "Properties": {}, 
            "Type": "AWS::EC2::InternetGateway"
        }, 
        "NetworkAcl2DefaultACL": {
            "Properties": {
                "Tags": [ {"Key" : "Application", "Value" : { "Ref" : "AWS::StackId"}} ], 
                "VpcId": {
                    "Ref": "VPC2vpc"
                }
            }, 
            "Type": "AWS::EC2::NetworkAcl"
        }, 
        "NetworkAcl2DefaultACL2AssociationSet20": {
            "Properties": {
                "NetworkAclId": {
                    "Ref": "NetworkAcl2DefaultACL"
                }, 
                "SubnetId": {
                    "Ref": "Subnet2subnet0"
                }
            }, 
            "Type": "AWS::EC2::SubnetNetworkAclAssociation"
        }, 
        "NetworkInterface2host0eni0": {
            "Properties": {
                "GroupSet": [
                    {
                        "Ref": "SecurityGroup2DefaultSG"
                    }
                ], 
                "PrivateIpAddresses": [
                    {
                        "Primary": true, 
                        "PrivateIpAddress": "10.0.0.4"
                    }
                ], 
                "SourceDestCheck": true, 
                "SubnetId": {
                    "Ref": "Subnet2subnet0"
                }
            }, 
            "Type": "AWS::EC2::NetworkInterface"
        }, 
        "RouteTable2RT0": {
            "Properties": {
                "Tags": [ {"Key" : "Application", "Value" : { "Ref" : "AWS::StackId"}} ], 
                "VpcId": {
                    "Ref": "VPC2vpc"
                }
            }, 
            "Type": "AWS::EC2::RouteTable"
        }, 
        "RouteTable2RT02AssociationSet22": {
            "Properties": {
                "RouteTableId": {
                    "Ref": "RouteTable2RT0"
                }, 
                "SubnetId": {
                    "Ref": "Subnet2subnet0"
                }
            }, 
            "Type": "AWS::EC2::SubnetRouteTableAssociation"
        }, 
        "RouteTable2RT02RouteSet21": {
            "Properties": {
                "DestinationCidrBlock": "0.0.0.0/0", 
                "GatewayId": {
                    "Ref": "InternetGateway2Internetgateway"
                }, 
                "RouteTableId": {
                    "Ref": "RouteTable2RT0"
                }
            }, 
            "Type": "AWS::EC2::Route"
        }, 
        "SecurityGroup2DefaultSG": {
            "Properties": {
                "GroupDescription": "default VPC security group", 
                "Tags": [ {"Key" : "Application", "Value" : { "Ref" : "AWS::StackId"}} ], 
                "VpcId": {
                    "Ref": "VPC2vpc"
                }
            }, 
            "Type": "AWS::EC2::SecurityGroup"
        }, 
        "SecurityGroup2DefaultSG2Egress20": {
            "Properties": {
                "CidrIp": "0.0.0.0/0", 
                "FromPort": "0", 
                "GroupId": {
                    "Ref": "SecurityGroup2DefaultSG"
                }, 
                "IpProtocol": "-1", 
                "ToPort": "65535"
            }, 
            "Type": "AWS::EC2::SecurityGroupEgress"
        }, 
        "SecurityGroup2DefaultSG2Ingress20": {
            "Properties": {
                "CidrIp": "0.0.0.0/0", 
                "FromPort": "22", 
                "GroupId": {
                    "Ref": "SecurityGroup2DefaultSG"
                }, 
                "IpProtocol": "tcp", 
                "ToPort": "22"
            }, 
            "Type": "AWS::EC2::SecurityGroupIngress"
        }, 
        "SecurityGroup2DefaultSG2IpPermissions22": {
            "Properties": {
                "CidrIp": "0.0.0.0/0", 
                "FromPort": "22", 
                "GroupId": {
                    "Ref": "SecurityGroup2DefaultSG"
                }, 
                "IpProtocol": "tcp", 
                "ToPort": "22"
            }, 
            "Type": "AWS::EC2::SecurityGroupIngress"
        }, 
        "Subnet2subnet0": {
            "Properties": {
                "AvailabilityZone": "one", 
                "CidrBlock": "10.0.0.0/24", 
                "Tags": [ {"Key" : "Application", "Value" : { "Ref" : "AWS::StackId"}} ], 
                "VpcId": {
                    "Ref": "VPC2vpc"
                }
            }, 
            "Type": "AWS::EC2::Subnet"
        }, 
        "VPC2vpc": {
            "Properties": {
                "CidrBlock": "10.0.0.0/16", 
                "InstanceTenancy": "default"
            }, 
            "Type": "AWS::EC2::VPC"
        }
    }
}
